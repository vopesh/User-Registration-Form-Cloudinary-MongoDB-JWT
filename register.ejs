<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vopesh's Page</title>
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Google Fonts - Inter -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Custom Styles (mimicking a separate style.css file) -->
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <header class="header-bar">
      <div class="author-text">by Vopesh</div>
      <div class="social-links">
        <a href="https://www.linkedin.com/in/vopeshchandra" target="_blank"
          >LinkedIn</a
        >
        <a href="https://github.com/vopesh" target="_blank">GitHub</a>
        <a
          href="https://public.tableau.com/app/profile/vopesh.chandra/vizzes"
          target="_blank"
          >Tableau</a
        >
      </div>
    </header>
    <div class="form-container">
      <h2>Register</h2>
      <p class="login-prompt">
        Already have an account? <a href="/login">Login</a>
      </p>
      <div id="validation-error" class="error-message"></div>
      <form
        id="registration-form"
        action="/register"
        method="post"
        enctype="multipart/form-data"
      >
        <!-- Name Field -->
        <div class="form-group">
          <label for="name">Name:</label>
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Enter your full name"
            required
          />
        </div>

        <!-- Country Field -->
        <div class="form-group">
          <label for="country">Country:</label>
          <select id="country" name="country" required>
            <option value="">Select your country</option>
            <option value="US">United States</option>
            <option value="CA">Canada</option>
            <option value="GB">United Kingdom</option>
            <option value="AU">Australia</option>
            <option value="DE">Germany</option>
            <option value="FR">France</option>
            <option value="IN">India</option>
            <option value="JP">Japan</option>
            <option value="BR">Brazil</option>
            <option value="CN">China</option>
            <!-- Add more countries as needed -->
            <option value="AF">Afghanistan</option>
            <option value="AL">Albania</option>
            <option value="DZ">Algeria</option>
            <option value="AD">Andorra</option>
            <option value="AO">Angola</option>
            <option value="AR">Argentina</option>
            <option value="AM">Armenia</option>
            <option value="AW">Aruba</option>
            <option value="AT">Austria</option>
            <option value="AZ">Azerbaijan</option>
            <option value="BS">Bahamas</option>
            <option value="BH">Bahrain</option>
            <option value="BD">Bangladesh</option>
            <option value="BB">Barbados</option>
            <option value="BY">Belarus</option>
            <option value="BE">Belgium</option>
            <option value="BZ">Belize</option>
            <option value="BJ">Benin</option>
            <option value="BT">Bhutan</option>
            <option value="BO">Bolivia</option>
            <option value="BA">Bosnia and Herzegovina</option>
            <option value="BW">Botswana</option>
            <option value="BG">Bulgaria</option>
            <option value="BF">Burkina Faso</option>
            <option value="BI">Burundi</option>
            <option value="CV">Cabo Verde</option>
            <option value="KH">Cambodia</option>
            <option value="CM">Cameroon</option>
            <option value="CF">Central African Republic</option>
            <option value="TD">Chad</option>
            <option value="CL">Chile</option>
            <option value="CO">Colombia</option>
            <option value="KM">Comoros</option>
            <option value="CD">Congo (DRC)</option>
            <option value="CG">Congo (Republic)</option>
            <option value="CR">Costa Rica</option>
            <option value="CI">CÃ´te d'Ivoire</option>
            <option value="HR">Croatia</option>
            <option value="CU">Cuba</option>
            <option value="CY">Cyprus</option>
            <option value="CZ">Czechia</option>
            <option value="DK">Denmark</option>
            <option value="DJ">Djibouti</option>
            <option value="DM">Dominica</option>
            <option value="DO">Dominican Republic</option>
            <option value="EC">Ecuador</option>
            <option value="EG">Egypt</option>
            <option value="SV">El Salvador</option>
            <option value="GQ">Equatorial Guinea</option>
            <option value="ER">Eritrea</option>
            <option value="EE">Estonia</option>
            <option value="SZ">Eswatini</option>
            <option value="ET">Ethiopia</option>
            <option value="FJ">Fiji</option>
            <option value="FI">Finland</option>
            <option value="GA">Gabon</option>
            <option value="GM">Gambia</option>
            <option value="GE">Georgia</option>
            <option value="GH">Ghana</option>
            <option value="GR">Greece</option>
            <option value="GD">Grenada</option>
            <option value="GT">Guatemala</option>
            <option value="GN">Guinea</option>
            <option value="GW">Guinea-Bissau</option>
            <option value="GY">Guyana</option>
            <option value="HT">Haiti</option>
            <option value="HN">Honduras</option>
            <option value="HU">Hungary</option>
            <option value="IS">Iceland</option>
            <option value="ID">Indonesia</option>
            <option value="IR">Iran</option>
            <option value="IQ">Iraq</option>
            <option value="IE">Ireland</option>
            <option value="IL">Israel</option>
            <option value="IT">Italy</option>
            <option value="JM">Jamaica</option>
            <option value="JO">Jordan</option>
            <option value="KZ">Kazakhstan</option>
            <option value="KE">Kenya</option>
            <option value="KI">Kiribati</option>
            <option value="KP">Korea (North)</option>
            <option value="KR">Korea (South)</option>
            <option value="KW">Kuwait</option>
            <option value="KG">Kyrgyzstan</option>
            <option value="LA">Laos</option>
            <option value="LV">Latvia</option>
            <option value="LB">Lebanon</option>
            <option value="LS">Lesotho</option>
            <option value="LR">Liberia</option>
            <option value="LY">Libya</option>
            <option value="LI">Liechtenstein</option>
            <option value="LT">Lithuania</option>
            <option value="LU">Luxembourg</option>
            <option value="MG">Madagascar</option>
            <option value="MW">Malawi</option>
            <option value="MY">Malaysia</option>
            <option value="MV">Maldives</option>
            <option value="ML">Mali</option>
            <option value="MT">Malta</option>
            <option value="MH">Marshall Islands</option>
            <option value="MR">Mauritania</option>
            <option value="MU">Mauritius</option>
            <option value="MX">Mexico</option>
            <option value="FM">Micronesia</option>
            <option value="MD">Moldova</option>
            <option value="MC">Monaco</option>
            <option value="MN">Mongolia</option>
            <option value="ME">Montenegro</option>
            <option value="MA">Morocco</option>
            <option value="MZ">Mozambique</option>
            <option value="MM">Myanmar</option>
            <option value="NA">Namibia</option>
            <option value="NR">Nauru</option>
            <option value="NP">Nepal</option>
            <option value="NL">Netherlands</option>
            <option value="NZ">New Zealand</option>
            <option value="NI">Nicaragua</option>
            <option value="NE">Niger</option>
            <option value="NG">Nigeria</option>
            <option value="MK">North Macedonia</option>
            <option value="NO">Norway</option>
            <option value="OM">Oman</option>
            <option value="PK">Pakistan</option>
            <option value="PW">Palau</option>
            <option value="PA">Panama</option>
            <option value="PG">Papua New Guinea</option>
            <option value="PY">Paraguay</option>
            <option value="PE">Peru</option>
            <option value="PH">Philippines</option>
            <option value="PL">Poland</option>
            <option value="PT">Portugal</option>
            <option value="QA">Qatar</option>
            <option value="RO">Romania</option>
            <option value="RU">Russia</option>
            <option value="RW">Rwanda</option>
            <option value="KN">Saint Kitts and Nevis</option>
            <option value="LC">Saint Lucia</option>
            <option value="VC">Saint Vincent and the Grenadines</option>
            <option value="WS">Samoa</option>
            <option value="SM">San Marino</option>
            <option value="ST">Sao Tome and Principe</option>
            <option value="SA">Saudi Arabia</option>
            <option value="SN">Senegal</option>
            <option value="RS">Serbia</option>
            <option value="SC">Seychelles</option>
            <option value="SL">Sierra Leone</option>
            <option value="SG">Singapore</option>
            <option value="SK">Slovakia</option>
            <option value="SI">Slovenia</option>
            <option value="SB">Solomon Islands</option>
            <option value="SO">Somalia</option>
            <option value="ZA">South Africa</option>
            <option value="SS">South Sudan</option>
            <option value="ES">Spain</option>
            <option value="LK">Sri Lanka</option>
            <option value="SD">Sudan</option>
            <option value="SR">Suriname</option>
            <option value="SE">Sweden</option>
            <option value="CH">Switzerland</option>
            <option value="SY">Syria</option>
            <option value="TW">Taiwan</option>
            <option value="TJ">Tajikistan</option>
            <option value="TZ">Tanzania</option>
            <option value="TH">Thailand</option>
            <option value="TL">Timor-Leste</option>
            <option value="TG">Togo</option>
            <option value="TO">Tonga</option>
            <option value="TT">Trinidad and Tobago</option>
            <option value="TN">Tunisia</option>
            <option value="TR">Turkey</option>
            <option value="TM">Turkmenistan</option>
            <option value="TV">Tuvalu</option>
            <option value="UG">Uganda</option>
            <option value="UA">Ukraine</option>
            <option value="AE">United Arab Emirates</option>
            <option value="UY">Uruguay</option>
            <option value="UZ">Uzbekistan</option>
            <option value="VU">Vanuatu</option>
            <option value="VA">Vatican City</option>
            <option value="VE">Venezuela</option>
            <option value="VN">Vietnam</option>
            <option value="YE">Yemen</option>
            <option value="ZM">Zambia</option>
            <option value="ZW">Zimbabwe</option>
          </select>
        </div>

        <!-- Phone Field -->
        <div class="form-group">
          <label for="phone">Phone:</label>
          <div class="phone-input-group">
            <select
              id="country-code"
              name="country_code"
              class="country-code-select"
              required
            >
              <option value="">Code</option>
              <option value="+1">+1 (USA/Canada)</option>
              <option value="+44">+44 (UK)</option>
              <option value="+91">+91 (India)</option>
              <option value="+61">+61 (Australia)</option>
              <option value="+49">+49 (Germany)</option>
              <option value="+33">+33 (France)</option>
              <option value="+81">+81 (Japan)</option>
              <option value="+86">+86 (China)</option>
              <option value="+55">+55 (Brazil)</option>
              <!-- Add more country codes as needed -->
              <option value="+93">Afghanistan (+93)</option>
              <option value="+355">Albania (+355)</option>
              <option value="+213">Algeria (+213)</option>
              <option value="+376">Andorra (+376)</option>
              <option value="+244">Angola (+244)</option>
              <option value="+54">Argentina (+54)</option>
              <option value="+374">Armenia (+374)</option>
              <option value="+297">Aruba (+297)</option>
              <option value="+43">Austria (+43)</option>
              <option value="+994">Azerbaijan (+994)</option>
              <option value="+1-242">Bahamas (+1-242)</option>
              <option value="+973">Bahrain (+973)</option>
              <option value="+880">Bangladesh (+880)</option>
              <option value="+1-246">Barbados (+1-246)</option>
              <option value="+375">Belarus (+375)</option>
              <option value="+32">Belgium (+32)</option>
              <option value="+501">Belize (+501)</option>
              <option value="+229">Benin (+229)</option>
              <option value="+975">Bhutan (+975)</option>
              <option value="+591">Bolivia (+591)</option>
              <option value="+387">Bosnia and Herzegovina (+387)</option>
              <option value="+267">Botswana (+267)</option>
              <option value="+359">Bulgaria (+359)</option>
              <option value="+226">Burkina Faso (+226)</option>
              <option value="+257">Burundi (+257)</option>
              <option value="+238">Cabo Verde (+238)</option>
              <option value="+855">Cambodia (+855)</option>
              <option value="+237">Cameroon (+237)</option>
              <option value="+236">Central African Republic (+236)</option>
              <option value="+235">Chad (+235)</option>
              <option value="+56">Chile (+56)</option>
              <option value="+57">Colombia (+57)</option>
              <option value="+269">Comoros (+269)</option>
              <option value="+243">Congo (DRC) (+243)</option>
              <option value="+242">Congo (Republic) (+242)</option>
              <option value="+506">Costa Rica (+506)</option>
              <option value="+225">CÃ´te d'Ivoire (+225)</option>
              <option value="+385">Croatia (+385)</option>
              <option value="+53">Cuba (+53)</option>
              <option value="+357">Cyprus (+357)</option>
              <option value="+420">Czechia (+420)</option>
              <option value="+45">Denmark (+45)</option>
              <option value="+253">Djibouti (+253)</option>
              <option value="+1-767">Dominica (+1-767)</option>
              <option value="+1-809">Dominican Republic (+1-809)</option>
              <option value="+593">Ecuador (+593)</option>
              <option value="+20">Egypt (+20)</option>
              <option value="+503">El Salvador (+503)</option>
              <option value="+240">Equatorial Guinea (+240)</option>
            </select>
            <input
              type="tel"
              id="phone"
              name="phone"
              placeholder="e.g., 123-456-7890"
              pattern="[0-9]{3}-?[0-9]{3}-?[0-9]{4}"
              title="Format: 123-456-7890 or 1234567890"
            />
          </div>
        </div>

        <!-- Email Field -->
        <div class="form-group">
          <label for="email">Email:</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="e.g., your.email@example.com"
            required
          />
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <label for="password">Password:</label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Create your password"
            required
          />
          <i class="fa fa-eye toggle-password"></i>
          <div class="password-requirements">
            <p>
              <i class="fa-solid fa-times-circle" id="length-check"></i> At
              least 10 characters
            </p>
            <p>
              <i class="fa-solid fa-times-circle" id="capital-check"></i> At
              least 1 Capital letter
            </p>
            <p>
              <i class="fa-solid fa-times-circle" id="small-check"></i> At least
              1 Small letter
            </p>
            <p>
              <i class="fa-solid fa-times-circle" id="digit-check"></i> At least
              1 Digit
            </p>
            <p>
              <i class="fa-solid fa-times-circle" id="special-check"></i> At
              least 1 special character ($, @, *)
            </p>
          </div>
        </div>

        <!-- Confirm Password Field -->
        <div class="form-group">
          <label for="confirm-password">Confirm Password:</label>
          <input
            type="password"
            id="confirm-password"
            name="confirm-password"
            placeholder="Confirm your password"
            required
          />
        </div>

        <!-- Photo Upload Field -->
        <div class="form-group">
          <label for="photo">Photo:</label>
          <input
            type="file"
            id="photo"
            name="photo"
            accept="image/jpeg,image/png,image/webp"
            required
          />
        </div>
        <input type="hidden" name="fullPhone" id="fullPhone" />

        <!-- Submit Button -->
        <button type="submit">Submit</button>
      </form>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const registrationForm = document.getElementById("registration-form");
        const passwordInput = document.getElementById("password");
        const confirmPasswordInput =
          document.getElementById("confirm-password");
        const errorDiv = document.getElementById("validation-error");
        const countrySelect = document.getElementById("country");
        const countryCodeSelect = document.getElementById("country-code");
        const phoneNumberInput = document.getElementById("phone");

        // Password requirement feedback elements
        const lengthCheck = document.getElementById("length-check");
        const capitalCheck = document.getElementById("capital-check");
        const smallCheck = document.getElementById("small-check");
        const digitCheck = document.getElementById("digit-check");
        const specialCheck = document.getElementById("special-check");

        // Function to update password requirement feedback
        function updatePasswordRequirements() {
          const password = passwordInput.value;

          // Regex for individual checks
          const hasCapital = /[A-Z]/.test(password);
          const hasSmall = /[a-z]/.test(password);
          const hasDigit = /\d/.test(password);
          const hasSpecial = /[$@*]/.test(password);
          const isLongEnough = password.length >= 10;

          // Update UI for each check
          updateCheckIcon(lengthCheck, isLongEnough);
          updateCheckIcon(capitalCheck, hasCapital);
          updateCheckIcon(smallCheck, hasSmall);
          updateCheckIcon(digitCheck, hasDigit);
          updateCheckIcon(specialCheck, hasSpecial);
        }

        function updateCheckIcon(element, isValid) {
          element.classList.remove("fa-check-circle", "fa-times-circle");
          element.classList.add(
            isValid ? "fa-check-circle" : "fa-times-circle"
          );
          element.style.color = isValid ? "#28a745" : "#dc3545";
        }

        // Listen for input on the password field to provide real-time feedback
        passwordInput.addEventListener("input", updatePasswordRequirements);

        // Initial update when page loads (useful if autofill occurs)
        updatePasswordRequirements();

        registrationForm.addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent the default form submission

          const name = document.getElementById("name").value.trim();
          const selectedCountry = countrySelect.value;
          const selectedCountryCode = countryCodeSelect.value;
          const phoneNumber = phoneNumberInput.value.trim();
          const email = document.getElementById("email").value.trim();
          const password = passwordInput.value.trim();
          const confirmPassword = confirmPasswordInput.value.trim();
          const photo = document.getElementById("photo");
          let messages = [];

          // ========== PHONE NUMBER COMBINING ==========
          // Get the hidden input field
          const fullPhoneInput = document.getElementById("fullPhone");
          // Clean the phone number (remove all non-digits)
          const cleanedPhoneNumb = phoneNumber.replace(/\D/g, "");
          // Combine country code and cleaned phone number
          fullPhoneInput.value = `${selectedCountryCode}-${cleanedPhoneNumb}`;
          // ========== END PHONE NUMBER COMBINING ==========

          // Reset error messages
          errorDiv.innerHTML = "";
          errorDiv.style.display = "none";

          // Add this to sync country selection with country code
          countrySelect.addEventListener("change", function () {
            const countryToCode = {
              US: "+1",
              IN: "+91",
              GB: "+44", // Add all mappings
            };
            countryCodeSelect.value = countryToCode[this.value] || "";
          });

          // Validate Name
          if (name === "") {
            messages.push("Name cannot be blank.");
          }

          // Validate Country
          if (selectedCountry === "") {
            messages.push("Please select your Country.");
          }

          // Validate Phone Country Code
          if (selectedCountryCode === "") {
            messages.push(
              "Please select a Country Code for your phone number."
            );
          }

          // Validate Phone Number (10 digits, local part)
          const phoneRegex = /^\d{10}$/;
          const cleanedPhoneNumber = phoneNumber.replace(/-/g, ""); // Remove hyphens for validation
          if (phoneNumber === "") {
            messages.push("Phone number cannot be blank.");
          } else if (!phoneRegex.test(cleanedPhoneNumber)) {
            messages.push(
              "Phone number must be a 10-digit number (e.g., 1234567890 or 123-456-7890)."
            );
          }

          // Validate Email
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (email === "") {
            messages.push("Email cannot be blank.");
          } else if (!emailRegex.test(email)) {
            messages.push("Please enter a valid email address.");
          }

          // Validate Password Complexity
          const passwordComplexityRegex =
            /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@*])[A-Za-z\d$@*]{10,}$/;

          if (password === "") {
            messages.push("Password cannot be blank.");
          } else if (!passwordComplexityRegex.test(password)) {
            // Check individual requirements to give specific feedback
            if (password.length < 10)
              messages.push("Password must be at least 10 characters long.");
            if (!/[A-Z]/.test(password))
              messages.push(
                "Password must contain at least one capital letter."
              );
            if (!/[a-z]/.test(password))
              messages.push("Password must contain at least one small letter.");
            if (!/\d/.test(password))
              messages.push("Password must contain at least one digit.");
            if (!/[$@*]/.test(password))
              messages.push(
                "Password must contain at least one of these special characters: $, @, or *."
              );
            if (/[^A-Za-z\d$@*]/.test(password))
              messages.push(
                "Password contains disallowed special characters. Only $, @, * are allowed."
              );
          }

          // Validate Confirm Password
          if (confirmPassword === "") {
            messages.push("Confirm Password cannot be blank.");
          } else if (password !== confirmPassword) {
            messages.push("Password and Confirm Password must match.");
          }

          // Validate Photo
          if (photo.files.length === 0) {
            messages.push("Photo file cannot be blank. Please upload a file.");
          }

          // In your validation section, consider adding:
          if (photo.files[0] && photo.files[0].size > 5 * 1024 * 1024) {
            messages.push("Photo must be smaller than 5MB");
          }

          // Display errors or submit form
          if (messages.length > 0) {
            errorDiv.style.display = "block";
            errorDiv.style.backgroundColor =
              "#ffe0e0"; /* Light red for errors */
            errorDiv.style.color = "#d32f2f"; /* Dark red text */
            errorDiv.style.borderColor = "#d32f2f";
            errorDiv.innerHTML = messages
              .map((msg) => `<p>${msg}</p>`)
              .join("");
          } else {
            // If all validations pass, you can submit the form here
            // For this example, we'll just log a success message
            errorDiv.style.display = "block";
            errorDiv.style.backgroundColor =
              "#d4edda"; /* Light green for success */
            errorDiv.style.color = "#155724"; /* Dark green text */
            errorDiv.style.borderColor = "#28a745";
            //errorDiv.innerHTML = "<p>Form submitted successfully!</p>";
            // In a real application, you would submit the form:
            this.submit();
          }
        });
      });
    </script>
    <script>
      document
        .querySelector(".toggle-password")
        .addEventListener("click", function () {
          const pwField = document.getElementById("password");
          pwField.type = pwField.type === "password" ? "text" : "password";
          this.classList.toggle("fa-eye-slash");
        });
    </script>
  </body>
</html>
